<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Demand Prediction</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 20px;
            text-align: center;
        }
        h2 {
            color: #333;
        }
        form {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            max-width: 400px;
            margin: auto;
        }
        label {
            display: block;
            margin-top: 10px;
            text-align: left;
        }
        input {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        button {
            background: #007BFF;
            color: white;
            border: none;
            padding: 10px;
            margin-top: 15px;
            cursor: pointer;
            width: 100%;
            border-radius: 4px;
        }
        button:hover {
            background: #0056b3;
        }
        h3 {
            color: #555;
        }
    </style>
    <script>
        function updateDateFields() {
            let date = new Date(document.getElementById("date").value);
            if (!isNaN(date.getTime())) {
                let year = date.getFullYear();
                let month = date.getMonth() + 1;
                let day = date.getDate();
                let weekday = date.getDay();
                
                document.getElementById("year").value = year;
                document.getElementById("month").value = month;
                document.getElementById("day").value = day;
                document.getElementById("weekday").value = weekday;
                
                let dayNames = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
                let monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
                
                document.querySelectorAll("[name^='Day of Week_']").forEach(el => el.value = 0);
                document.querySelector(`[name='Day of Week_${dayNames[weekday]}']`).value = 1;
                
                document.querySelectorAll("[name^='Month_']").forEach(el => el.value = 0);
                document.querySelector(`[name='Month_${monthNames[month - 1]}']`).value = 1;
                
                document.getElementById("season_summer").value = (month >= 6 && month <= 8) ? 1 : 0;
                document.getElementById("season_winter").value = (month == 12 || month <= 2) ? 1 : 0;
            }
        }
        
        async function predictDemand(event) {
            event.preventDefault();
            let formData = new FormData(document.getElementById("predictionForm"));
            let data = {};
            formData.forEach((value, key) => data[key] = isNaN(value) ? value : Number(value));
            
            let response = await fetch("/predict", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify([data])
            });
            
            let result = await response.json();
            document.getElementById("result").innerText = result.predictions ? `Predicted Demand: ${result.predictions[0]}` : `Error: ${result.error}`;
        }
    </script>
</head>
<body>
    <h2>Demand Prediction</h2>
    <form id="predictionForm" onsubmit="predictDemand(event)">
        <label>Supply: <input type="number" name="Supply" required></label>
        <label>Weekend? (0/1): <input type="number" name="Weekend?" required></label>
        <label>lag_1: <input type="number" name="lag_1" required></label>
        <label>Select Date: <input type="date" id="date" onchange="updateDateFields()" required></label>
        <label>weekday: <input type="number" id="weekday" name="weekday" readonly></label>
        <label>Year: <input type="number" id="year" name="year" readonly></label>
        <label>Month: <input type="number" id="month" name="month" readonly></label>
        <label>Day: <input type="number" id="day" name="day" readonly></label>
        
        <h3>Day of the Week</h3>
        <input type="hidden" name="Day of Week_Monday" value="0">
        <input type="hidden" name="Day of Week_Tuesday" value="0">
        <input type="hidden" name="Day of Week_Wednesday" value="0">
        <input type="hidden" name="Day of Week_Thursday" value="0">
        <input type="hidden" name="Day of Week_Friday" value="0">
        <input type="hidden" name="Day of Week_Saturday" value="0">
        <input type="hidden" name="Day of Week_Sunday" value="0">
        
        <h3>Month</h3>
        <input type="hidden" name="Month_January" value="0">
        <input type="hidden" name="Month_February" value="0">
        <input type="hidden" name="Month_March" value="0">
        <input type="hidden" name="Month_April" value="0">
        <input type="hidden" name="Month_May" value="0">
        <input type="hidden" name="Month_June" value="0">
        <input type="hidden" name="Month_July" value="0">
        <input type="hidden" name="Month_August" value="0">
        <input type="hidden" name="Month_September" value="0">
        <input type="hidden" name="Month_October" value="0">
        <input type="hidden" name="Month_November" value="0">
        <input type="hidden" name="Month_December" value="0">
        
        <h3>Season</h3>
        <input type="hidden" id="season_summer" name="season_summer" value="0">
        <input type="hidden" id="season_winter" name="season_winter" value="0">
        
        <button type="submit">Predict</button>
    </form>
    <h3 id="result"></h3>
</body>
</html>
